" =============================================================================
" IDEAVIM CONFIGURATION
" =============================================================================

" =============================================================================
" PLUGINS
" =============================================================================
set surround
set multiple-cursors
set commentary
set argtextobj
set easymotion
set textobj-entire
set ReplaceWithRegister
set exchange
set ideajoin

" External plugins
Plug 'machakann/vim-highlightedyank'
Plug 'preservim/nerdtree'
Plug 'tpope/vim-commentary'

" =============================================================================
" GENERAL SETTINGS
" =============================================================================
let mapleader = " "

" Search settings
set hlsearch
set ignorecase
set incsearch
set smartcase

" Display settings
set scrolloff=10
set matchpairs+=<:>

" =============================================================================
" INSERT MODE MAPPINGS
" =============================================================================
imap <C-h> <Left>
imap <C-j> <Down>
imap <C-k> <Up>
imap <C-l> <Right>

" =============================================================================
" NAVIGATION MAPPINGS
" =============================================================================
" Split navigation
nmap <C-h> <C-w>h
nmap <C-j> <C-w>j
nmap <C-k> <C-w>k
nmap <C-l> <C-w>l

" Tab navigation
nmap <Tab> gt
nmap <S-Tab> gT

" Buffer navigation
" map w [w
" map e ]w
" map b [b

" Quick jumps
map Q gq

" =============================================================================
" WINDOW MANAGEMENT
" =============================================================================
map <leader>sv :action SplitVertically<CR>
map <leader>sh :action SplitHorizontally<CR>
map <leader>sx :action Unsplit<CR>

" =============================================================================
" FILE OPERATIONS
" =============================================================================
nmap <leader>nb :action NewFile<CR>
nmap <leader>x :action CloseContent<CR>
nmap <leader>cba :action CloseAllEditors<CR>

" File explorer
nmap <leader>e :NERDTree<CR>
nmap <C-n> :NERDTreeToggle<CR>

" =============================================================================
" SEARCH AND FIND
" =============================================================================
nmap <leader>ff :action GotoFile<CR>
nmap <leader>fs :action GotoSymbol<CR>
nmap <leader>fw :action FindInPath<CR>
nmap <leader>fb :action Switcher<CR>
nmap <leader>fa :action GotoAction<CR>

" Toggle search highlighting
nmap <esc> :nohlsearch<CR>

" =============================================================================
" CODE NAVIGATION
" =============================================================================
nmap gd :action GotoDeclaration<CR>
nmap gD :action GotoTypeDeclaration<CR>
nmap gi :action GotoImplementation<CR>
nmap gr :action FindUsages<CR>
nmap gh :action ShowHoverInfo<CR>
nmap <leader>k <S-k>

" Navigate popups and menus with C-j/C-k
" These work in most IntelliJ popups, completions, and menus
sethandler <C-j> i:ide n:ide v:ide
sethandler <C-k> i:ide n:ide v:ide

" =============================================================================
" CODE ACTIONS AND REFACTORING
" =============================================================================
" Quick fix / code actions
nmap <leader>ca :action ShowIntentionActions<CR>
vmap <leader>ca :action ShowIntentionActions<CR>

" Generate code
nmap <leader>cg :action Generate<CR>

" Refactoring
nmap <leader>rn :action RenameElement<CR>
nmap <leader>rr :action RenameFile<CR>
nmap <leader>re :action Refactorings.QuickListPopupAction<CR>

" nmap <leader>rm :action ExtractMethod<CR>
" vmap <leader>rm :action ExtractMethod<CR>
" nmap <leader>rv :action IntroduceVariable<CR>
" vmap <leader>rv :action IntroduceVariable<CR>
" nmap <leader>rc :action IntroduceConstant<CR>
" vmap <leader>rc :action IntroduceConstant<CR>
" nmap <leader>rp :action IntroduceParameter<CR>
" vmap <leader>rp :action IntroduceParameter<CR>

" Optimize imports and format
nmap <leader>oi :action OptimizeImports<CR>
nmap <leader>fm :action ReformatCode<CR>

" =============================================================================
" DEBUGGING AND RUN
" =============================================================================
" nmap <leader>db :action ToggleLineBreakpoint<CR>
" nmap <leader>dr :action Run<CR>
" nmap <leader>dd :action Debug<CR>
" nmap <leader>ds :action Stop<CR>

" =============================================================================
" TEXT EDITING
" =============================================================================
" Redo mapping
nmap U <C-r>

" Move lines
nmap <A-j> :m .+1<CR>==
nmap <A-k> :m .-2<CR>==
vmap <A-j> :m '>+1<CR>gv=gv
vmap <A-k> :m '<-2<CR>gv=gv

" Clipboard operations
nmap <leader>y "+y
vmap <leader>y "+y
nmap <leader>p "+p
vmap <leader>p "+p

" =============================================================================
" IDE SPECIFIC
" =============================================================================
" Settings and config
nnoremap <C-,> :action ShowSettings<CR>
noremap <leader>cc :edit ~/.ideavimrc<CR>
noremap <leader>cs :source ~/.ideavimrc<CR>

" Toggle features
nmap <leader><leader>l :action EditorGutterToggleGlobalLineNumbers<CR>

" Error navigation
nmap ]d :action GotoNextError<CR>
nmap [d :action GotoPreviousError<CR>

" Git integration
" nmap <leader>gb :action Git.Branches<CR>
" nmap <leader>gc :action CheckinProject<CR>
" nmap <leader>gp :action Vcs.Push<CR>
" nmap <leader>gu :action Vcs.UpdateProject<CR>
